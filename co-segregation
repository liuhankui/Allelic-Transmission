AllelicTransmission<-function(ped,generation,genotype,maf){
         generation<-generation+1
         if(generation-1<ncol(ped)){
            Uped<-unique(ped[,c(generation-1,generation)])
            for(parent in unique(Uped[,1])){
                SUped<-Uped[Uped[,1]==parent,]
                childnumber<-nrow(SUped)
                parentGenotype<-as.numeric(genotype[genotype[,1]==paste0(generation-1,"_",parent),c(2,3)])
                parentMatingGenotype<-as.numeric(genotype[genotype[,1]==paste0(generation-1,"_",parent,"_mating"),c(2,3)])
                childAllele1<-sample(parentGenotype,childnumber,replace=T)
                childAllele2<-sample(parentMatingGenotype,childnumber,replace=T)
                resultTmp<-data.frame(ID=paste0(generation,"_",SUped[,2]),
                                      allele1=childAllele1,
                                      allele2=childAllele2)
                childMatingAllele1<-sample(c(0,1),childnumber,replace=T,prob=c(1-maf,maf))
                childMatingAllele2<-sample(c(0,1),childnumber,replace=T,prob=c(1-maf,maf))
                resultMatingTmp<-data.frame(ID=paste0(generation,"_",SUped[,2],"_mating"),
                                            allele1=childMatingAllele1,
                                            allele2=childMatingAllele2)
                genotype<-unique(rbind(genotype,resultTmp,resultMatingTmp))
            }
            coSeg(ped,generation,genotype,maf)
         }else{
            return(genotype)
         }
}
